{% extends 'base.html.twig' %}

{% block title %}Canevas{% endblock %}

{% block stylesheets %}
    <link href="{{ asset('plugins/toast/toast.css') }}" rel="stylesheet">
    <style>
        .table thead th {
            padding: 0 !important;
            text-align: center;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="container-fluid">
        <div class="row page-titles">
            <div class="col-md-5 col-8 align-self-center">
                <h3 class="text-themecolor">Accueil</h3>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ path('login.success') }}">Accueil</a></li>
                    <li class="breadcrumb-item"><a href="{{ path('recommendations.select') }}">Recommandation</a></li>
                    <li class="breadcrumb-item"><a href="javascript:void(0)">Canevas</a></li>
                    <li class="breadcrumb-item active"><a href="javascript:void(0)">{{ culture.name }}</a></li>
                </ol>
            </div>
            <div class="">
                <button id="open-right-sidebar" class="right-side-toggle waves-effect waves-light btn-success btn btn-circle btn-sm pull-right ml-2"><i class="ti-settings text-white"></i></button>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <h4 class="card-title">Canevas {{ culture.name }} <span class="badge badge-warning">Taille total {{ totalSize }} ha</span></h4>
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered no-wrap">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/1.png') }}" /><br />
                                        <p class="text-center">A</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/2 a.png') }}" /><br />
                                        <p class="text-center">B</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/2 b.png') }}" /><br />
                                        <p class="text-center">C2</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/3.png') }}" /><br />
                                        <p class="text-center">C3</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/4.png') }}" /><br />
                                        <p class="text-center">D</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/5.png') }}" /><br />
                                        <p class="text-center">E</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/6.png') }}" /><br />
                                        <p class="text-center">F</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/7.png') }}" /><br />
                                        <p class="text-center">G</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/8.png') }}" /><br />
                                        <p class="text-center">H</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/9.png') }}" /><br />
                                        <p class="text-center">I</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/10.png') }}" /><br />
                                        <p class="text-center">J</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/vergers.png') }}" /><br />
                                        <p class="text-center">15/20 mai</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/vergers.png') }}" /><br />
                                        <p class="text-center">10/15 juin</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/vergers.png') }}" /><br />
                                        <p class="text-center">Début Juillet</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/prune.png') }}" /><br />
                                        <p class="text-center">15-Juil</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/prune.png') }}" /><br />
                                        <p class="text-center">Fin Juil</p>
                                    </th>
                                    <th>
                                        <img class="" style="width: 64px" src="{{ asset('images/canevas/prune-dante/prune.png') }}" /><br />
                                        <p class="text-center">Mi-Août</p>
                                    </th>
                                </tr>
                                </thead>
                                <thead>
                                <tr>
                                    <th>Maladie</th>
                                    <th><small class="text-center">Bourgeons <br/> d'hiver</small></th>
                                    <th><small class="text-center">Bourgeons <br/> gonflés</small></th>
                                    <th><small class="text-center">Boutons <br/> visibles</small></th>
                                    <th><small class="text-center">Boutons <br/> vert</small></th>
                                    <th><small class="text-center">Boutons <br/> Blancs</small></th>
                                    <th><small class="text-center">Etamines <br/> visibles</small></th>
                                    <th><small class="text-center">Fleurs <br/> Ouvertes</small></th>
                                    <th><small class="text-center">Chute <br/> Pétales</small></th>
                                    <th><small class="text-center">Nouaison</small></th>
                                    <th><small class="text-center">Chute <br/> collerettes</small></th>
                                    <th><small class="text-center">Jeunes <br/> fruits</small></th>
                                </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Bactériose</td>
                                        <td colspan="2">
                                            <button class="btn btn-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">KOCIDE 2000 <small>3.5 KG</small></button>
                                        </td>
                                        <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
                                    </tr>
                                    <tr>
                                        <td>Pucerons</td>
                                        <td></td>
                                        <td colspan="2">
                                            <button class="btn btn-primary btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">KARATE XFLOW <small>0.076 KG</small></button>
                                        </td>
                                        <td></td><td></td><td></td><td></td><td></td>
                                        <td colspan="4">
                                            <button class="btn btn-primary btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">TEPEKI <small>0.140 Kg</small></button>
                                        </td>
                                        <td></td><td></td><td></td><td></td><td></td>
                                    </tr>
                                    <tr>
                                        <td>Acariens</td>
                                        <td></td>
                                        <td colspan="2">
                                            <button class="btn btn-primary btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">ACAKILL<small>20 L</small></button>
                                            <button class="btn btn-primary btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">POLITHIOL<small>25 L</small></button>
                                        </td>
                                        <td colspan="2">
                                            <button class="btn btn-primary btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">ADMIRAL PRO<small>0.3L</small></button>
                                        </td>
                                        <td></td><td></td><td></td><td></td><td></td>
                                        <td colspan="2">
                                            <button class="btn btn-primary btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">ADMIRAL PRO <small>0.3L</small></button>
                                            <button class="btn btn-primary btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">MOVENTO <small>1.9L</small></button>
                                        </td>
                                        <td></td><td></td><td></td> <td></td> <td></td>
                                    </tr>
                                    <tr>
                                        <td>Monilia Laxa</td>
                                        <td></td><td></td><td></td><td></td>
                                        <td colspan="3">
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">SERENVA <small>0.2 KG</small></button>
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">TOPSIN <small>1 KG</small></button>
                                        </td>
                                        <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
                                    </tr>
                                    <tr>
                                        <td>Regulateur</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                        <td>
                                            <button class="btn btn-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">REGALIS plus <small>1.250 KG</small></button>
                                        </td>
                                        <td colspan="2">
                                            <button class="btn btn-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">REGALIS plus <small>1.250 KG</small></button>
                                        </td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                    </tr>
                                    <tr>
                                        <td>Tavelure</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                        <td colspan="3">
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">MERPAN SC <small>3L</small></button>
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">DELAN WG <small>0.5kg</small></button>
                                        </td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                    </tr>
                                    <tr>
                                        <td>Rouille</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                        <td colspan="7">
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">DELAN WG <small>0.5 kg</small></button>
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">MANCOWAN PLUS <small>2kg</small></button>
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">LUNA Experience <small>0.5L</small></button>
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">SIGNUM <small>0.45kg</small></button>
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">HORIZON ARBO <small>0.6kg</small></button>
                                        </td>
                                        <td></td> <td></td>
                                    </tr>
                                    <tr>
                                        <td>Phytoptes</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                        <td colspan="4">
                                            <button class="btn btn-danger btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">CITROTHIOL DG <small>8 kg</small></button>
                                        </td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td>
                                    </tr>
                                    <tr>
                                        <td>Carpocapses</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                        <td colspan="4">
                                            <button class="btn btn-purple btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INSEGAR <small>0.3 kg</small></button>
                                            <button class="btn btn-purple btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">DIPEL DF <small>1 kg</small></button>
                                        </td>
                                        <td colspan="2">
                                            <button class="btn btn-purple btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">DELEGATE <small>0.3 kg</small></button>
                                            <button class="btn btn-purple btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">CORAGEN <small>0.175 kg</small></button>
                                        </td>
                                        <td></td> <td></td> <td></td>
                                    </tr>
                                    <tr>
                                        <td>Nutrition Foliaire</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                        <td>
                                            <button class="btn btn-light-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INO GREEN N <small>5 L</small></button>
                                            <button class="btn btn-light-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INO ALG NPK <small>3 À 5 L</small></button>
                                        </td>
                                        <td>
                                            <button class="btn btn-light-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INO MN 120 <small>3 L</small></button>
                                        </td>
                                        <td colspan="3">
                                            <button class="btn btn-light-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INO MIX FRUIT <small>10 L</small></button>
                                            <button style="width: 50%; margin-top: 0.5rem" class="btn btn-light-warning isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INO ALG PB <small>5 L</small></button>
                                        </td>
                                        <td>
                                            <button class="btn btn-light-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INO MIX SUC <small>5 L</small></button>
                                        </td>
                                        <td colspan="3">
                                            <button class="btn btn-light-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">MEGAGREEN <small>2 KG</small></button>
                                            <button style="width: 50%; margin-top: 0.5rem" class="btn btn-light-warning isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INO MIX SUC <small>2 KG</small></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Stimulation</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                        <td colspan="5">
                                            <button class="btn btn-success btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">FOLWIN <small>2 L</small></button>
                                        </td>
                                        <td></td>
                                        <td colspan="3">
                                            <button class="btn btn-success btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INTRACELL <small>4 Kg</small></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Anti-Chlorose</td>
                                        <td></td>
                                        <td colspan="3">
                                            <button class="btn btn-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">SFEROSOL <small>300 Kg</small></button>
                                            <button class="btn btn-warning btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">CHELAFER AA 6% <small>60 à 120 gr/arbre</small></button>
                                        </td>
                                        <td></td> <td></td> <td></td> <td></td>
                                        <td colspan="7">
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">INO CHEL ULTRA <small>3 L</small></button>
                                        </td>
                                        <td></td> <td></td>
                                    </tr>
                                    <tr>
                                        <td>Anti-Chlorose</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td>
                                        <td colspan="3">
                                            <button class="btn btn-danger btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">MASAÎ <small>0.5 Kg</small></button>
                                        </td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td>
                                    </tr>
                                    <tr>
                                        <td>Monilia</td>
                                        <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td><td></td><td></td>
                                        <td colspan="3">
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">HORIZON ARBO <small>0.6 Kg</small></button>
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">SIGNUM <small>0.75 Kg</small></button>
                                            <button class="btn btn-info btn-block isProduct" product_slug="REMPLACE" dose="REMPLACE" unit="REMPLACE">KRUGA <small>2 L</small></button>
                                        </td>
                                        <td></td> <td></td> <td></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="alert alert-success">SODEPAC est certifiée CSA-GTP (Sécurité Sanitaire) N°GT090087 et 2BSsv (Durabilité Agro Carburants) N°2BS030038 <br> Distribution de produits Phytopharmaceutiques à des utilisateurs professionnels et non professionnels. N°Agrément: 4700008 </div>
            </div>
        </div>
    </div>
    <div id="right-sidebar" class="right-sidebar">
        <div class="slimscrollright">
            <div class="rpanel-title"> LISTE PRODUITS CHOISIS <span><i id="close-right-sidebar" class="ti-close right-side-toggle"></i></span>
            </div>
            <div class="r-panel-body">
                <ul class="mt-2" id="products_list">
                </ul>
                <a href="{{ path('recommendations.synthese.products', {id: recommendations.id}) }}" class="btn btn-success btn-block mt-3">Valider les produits</a>
            </div>

        </div>
    </div>
{% endblock %}
{% block javascripts %}
    <script src="{{ asset('plugins/toast/toast.js') }}"></script>
    <script>
        $("#open-right-sidebar").click(function(e){
            let sidebar = $('#right-sidebar');
            $(sidebar).addClass( "shw-rside" )
        });
        $("#close-right-sidebar").click(function(e){
            let sidebar = $('#right-sidebar');
            $(sidebar).removeClass( "shw-rside" )
        });
        $(".isProduct").click(function (e) {
            let name = $(this).text()
            $.ajax({
                url: '/recommendations/add-product',
                type: 'POST',
                data: {
                    'product_slug': $(this).attr('product_slug'),
                    'recommendation_id': {{ recommendations.id }},
                    'dose': $(this).attr('dose'),
                    'unit': $(this).attr('unit')
                },
                dataType: 'JSON',
                complete : function (response) {
                    $.toast({
                        heading: 'Produit ajouté avec succès',
                        text: 'Ajout de ' + name,
                        position: 'bottom-left',
                        loaderBg: '#ff6849',
                        icon: 'success',
                        hideAfter: 3000,
                        stack: 6
                    });
                    let nameProduct = response.responseJSON['name_product']
                    let dose = response.responseJSON['dose']
                    let unit = response.responseJSON['unit']
                    let input = '<li><b>'+ nameProduct +'</b> <small>'+ dose + unit +'</small></li>'
                    $('#products_list').append( input )
                },
                error : function (code_html, status) {
                    $.toast({
                        heading: 'Une erreur est survenue',
                        text: 'Veuillez ressayer',
                        position: 'bottom-right',
                        loaderBg: '#ff6849',
                        icon: 'error',
                        hideAfter: 3000,
                        stack: 6
                    });
                }
            })
        })
    </script>
{% endblock %}
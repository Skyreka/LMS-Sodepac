<!DOCTYPE html>
<html lang="fr-FR">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Skyreka">
        <title>{% block title %}{% endblock %} - {{ APP_NAME }}</title>
        <link href="{{ asset('plugins/bootstrap/css/bootstrap.min.css')}}" rel="stylesheet">
        <link href="{{ asset('css/style.css') }}" rel="stylesheet">
        <link href="{{ asset('css/colors/green.css') }}" id="theme" rel="stylesheet">
        <link rel="apple-touch-icon" sizes="180x180" href="{{ asset('images/favicon/apple-touch-icon.png') }}">
        <link rel="icon" type="image/png" sizes="32x32" href="{{ asset('images/favicon/favicon-32x32.png') }}">
        <link rel="icon" type="image/png" sizes="16x16" href="{{ asset('images/favicon/favicon-16x16.png') }}">
        <link rel="manifest" href="{{ asset('images/favicon/site.webmanifest') }}">
        <link href="{{ asset('plugins/toast/toast.css') }}" rel="stylesheet">
        <style>
            .table thead th {
                padding-left: 15px;
                padding-right: 15px;
                text-align: center;
            }
            tr {
                border-top: 3px #7f8c8d solid;
            }
            .ti-menu {
                display: none !important;
            }
            .btn {
                font-size: 8px !important;
            }
            td {
              font-size: 9px;
            }
            .btn:hover {
              font-size: 10px !important;
            }
            thead p {
                font-size: 8px !important;
                text-align: justify !important;
            }
            .btn-R {
                background-color: #FFADAD !important;
            }
            .btn-O {
                background-color: #FFD6A5 !important;
            }
            .btn-J {
                background-color: #FDFFB6 !important;
            }
            .btn-V {
                background-color: #CAFFBF !important;
            }
            .btn-C {
                background-color: #9BF6FF !important;
            }
            .btn-B {
                background-color: #A0C4FF !important;
            }
            .btn-M {
                background-color: #FFC6FF !important;
            }
            .btn-A {
                background-color: #D8E2DC !important;
            }
            .exist {
                border: 3px solid #2ecc71;
            }
            .isProduct {
                display: block !important;
                margin: .25em 0 .25em 0 !important;
            }
        </style>
        {% block stylesheets %}{% endblock %}
        <!-- Special for Canevas -->
        <style>
            .page-wrapper {
                margin-left: 0 !important;
            }
            table {
                table-layout:fixed
            }
            th {
                min-width: 0 !important;
                padding: 0 !important;
                white-space:normal !important;
                word-wrap: break-word;
            }
            td {
                min-width: 0 !important;
                padding: 0 !important;
                white-space:normal !important;
                word-wrap: break-word;
            }
            button {
                white-space:normal !important;
                word-wrap: break-word;
            }
        </style>
    </head>
    <body class="fix-header card-no-border logo-center">
        <div id="main-wrapper">
            {{ include('_header.html.twig') }}
            <div class="page-wrapper">
                {% block body %}{% endblock %}
            </div>
            {% block modals %}{% endblock %}
        </div>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <!-- Bootstrap Js -->
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
        <!-- App -->
        <script src="{{ asset('js/sodepac.js') }}"></script>
        <script src="{{ asset('js/setup-canevas.js off') }}"></script>
        <!-- Special For Canevas -->
        <script src="{{ asset('plugins/toast/toast.js') }}"></script>
        <script>

          $("#open-right-sidebar").click(function(e){
                let sidebar = $('#right-sidebar');
                $(sidebar).addClass( "shw-rside" )
            });
            $("#close-right-sidebar").click(function(e){
                let sidebar = $('#right-sidebar');
                $(sidebar).removeClass( "shw-rside" )
            });
            $(".isProduct").click(function (e) {
                let name = $(this).text()
                $(this).addClass('btn-light-danger')
                $(this).addClass('exist')
                $.ajax({
                    url: '{{ path('recommendations_canevas_product_add') }}',
                    type: 'POST',
                    data: {
                        'product_slug': $(this).attr('product_slug'),
                        'recommendation_id': {{ recommendations.id }},
                        'dose': $(this).attr('dose'),
                        'c_id': $(this).attr('c_id'),
                        'unit': $(this).attr('unit')
                    },
                    dataType: 'JSON',
                    complete : function (response) {
                        $.toast({
                            heading: 'Produit ajouté avec succès',
                            text: 'Ajout de ' + name,
                            position: 'bottom-left',
                            loaderBg: '#ff6849',
                            icon: 'success',
                            hideAfter: 3000,
                            stack: 6
                        });
                        let nameProduct = response.responseJSON['name_product']
                        let dose = response.responseJSON['dose']
                        let unit = response.responseJSON['unit']
                        let input = '<li><b>'+ nameProduct +'</b> <small>'+ dose.toFixed(3) + unit +'</small></li>'
                        $('#products_list').append( input )
                    },
                    error : function (code_html, status) {
                        $.toast({
                            heading: 'Une erreur est survenue',
                            text: 'Veuillez ressayer',
                            position: 'bottom-right',
                            loaderBg: '#ff6849',
                            icon: 'error',
                            hideAfter: 3000,
                            stack: 6
                        });
                    }
                })
            })
        </script>
        {% block javascripts %}{% endblock %}
    </body>
</html>
